<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
  <title>Postman Lite üöÄ</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header>
    <button id="toggleSidebarBtn" title="·∫®n/Hi·ªán Sidebar">‚ò∞</button>
    <select id="method">
      <option>GET</option>
      <option>POST</option>
      <option>PUT</option>
      <option>PATCH</option>
      <option>DELETE</option>
    </select>
    <input id="url" placeholder="https://api.example.com/data" />
    <button id="sendBtn">G·ª≠i üöÄ</button>
    <button id="copyCurlBtn" title="Copy l·ªánh curl">Copy cURL üìã</button>
    <div class="env-select-wrapper">
      <select id="environmentSelect" title="Ch·ªçn environment"></select>
      <button id="manageEnvsBtn" title="Qu·∫£n l√Ω environments">üåê</button>
    </div>
  </header>
  <div class="top-bar-extensions">
    <input id="requestNameInput" placeholder="Request name (ƒë·ªÉ l∆∞u v√†o collection)" />
    <button id="saveCurrentBtn" title="L∆∞u request hi·ªán t·∫°i">üíæ L∆∞u</button>
    <div class="search-wrapper">
      <input id="sidebarSearch" placeholder="T√¨m trong collections..." />
    </div>
    <div class="data-transfer">
      <button id="exportDataBtn" title="Export d·ªØ li·ªáu JSON">‚¨áÔ∏è Export</button>
      <button id="importDataBtn" title="Import d·ªØ li·ªáu JSON">‚¨ÜÔ∏è Import</button>
    </div>
  </div>
  <div class="app-container">
    <aside class="sidebar">
      <div class="sidebar-header">
        <h3>üìö Collections</h3>
        <div class="sidebar-actions">
          <button id="newCollectionBtn" title="T·∫°o collection m·ªõi">üìÅ+</button>
          <button id="newRequestBtn" title="T·∫°o request m·ªõi">üìÑ+</button>
          <button id="clearAllBtn" title="X√≥a t·∫•t c·∫£ d·ªØ li·ªáu">üóëÔ∏è</button>
        </div>
      </div>
      <div class="sidebar-tabs">
        <button class="sidebar-tab active" data-tab="collections">Collections</button>
        <button class="sidebar-tab" data-tab="history">History</button>
      </div>
      <div class="sidebar-content" id="sidebarContent"><!-- dynamic --></div>
    </aside>
    <main>
      <div class="panel" style="flex:1">
        <div class="tabs">
          <div class="tab active" data-tab="params">Params</div>
          <div class="tab" data-tab="headers">Headers</div>
          <div class="tab" data-tab="auth">Auth</div>
          <div class="tab" data-tab="body">Body</div>
          <div class="tab" data-tab="cookies">Cookies</div>
          <div class="tab" data-tab="curl">From cURL</div>
        </div>
        <div id="params" class="tab-content">
          <div class="kv-container" id="paramsContainer"></div>
          <button class="add" onclick="App.addKV('paramsContainer')">+ Th√™m query</button>
        </div>
        <div id="headers" class="tab-content" style="display:none">
          <div class="kv-container" id="headersContainer"></div>
          <button class="add" onclick="App.addKV('headersContainer')">+ Th√™m header</button>
        </div>
        <div id="auth" class="tab-content" style="display:none">
          <label>Lo·∫°i Auth:
            <select id="authType">
              <option value="none">None</option>
              <option value="basic">Basic</option>
              <option value="bearer">Bearer Token</option>
              <option value="apikey">API Key</option>
            </select>
          </label>
          <div id="auth-basic" class="auth-section">
            <h4>Basic Auth</h4>
            <div class="inline">
              <input id="basicUser" placeholder="Username" />
              <input id="basicPass" placeholder="Password" type="password" />
            </div>
          </div>
          <div id="auth-bearer" class="auth-section">
            <h4>Bearer Token</h4>
            <input id="bearerToken" placeholder="Token" />
          </div>
          <div id="auth-apikey" class="auth-section">
            <h4>API Key</h4>
            <div class="inline">
              <input id="apiKeyName" placeholder="Key name (e.g. X-API-Key)" />
              <input id="apiKeyValue" placeholder="Key value" />
            </div>
            <label style="margin-top:6px;display:block">V·ªã tr√≠:
              <select id="apiKeyLocation">
                <option value="header">Header</option>
                <option value="query">Query</option>
              </select>
            </label>
          </div>
          <div id="curlPreview" style="display:none"></div>
        </div>
        <div id="cookies" class="tab-content" style="display:none">
          <div class="kv-container" id="cookiesContainer"></div>
          <button class="add" onclick="App.addKV('cookiesContainer')">+ Th√™m cookie</button>
        </div>
        <div id="body" class="tab-content" style="display:none">
          <label>Content-Type:
            <select id="contentType">
              <option value="application/json">application/json</option>
              <option value="text/plain">text/plain</option>
              <option value="application/x-www-form-urlencoded">form-urlencoded</option>
              <option value="multipart/form-data">multipart/form-data</option>
            </select>
          </label>
          <textarea id="bodyContent" placeholder='{"key": "value"}'></textarea>
          <input type="file" id="fileInput" style="margin-top:5px;display:none" multiple />
        </div>
        <div id="curl" class="tab-content" style="display:none">
          <textarea id="curlInput" placeholder="curl -X POST 'https://api.example.com/items?limit=10' -H 'Authorization: Bearer xxx' -H 'Content-Type: application/json' -d '{\n  \"name\": \"foo\"\n}'"></textarea>
          <div class="inline" style="margin-top:6px;">
            <button class="add" id="parseCurlBtn">Parse & Fill ‚§µÔ∏è</button>
            <span style="color:#9ab; font-size:12px;">H·ªó tr·ª£: -X/--request, -H/--header, -d/--data, -F/--form, -b/--cookie, -u/--user</span>
          </div>
          <div id="curlExplain" style="margin-top:6px; font-size:12px; color:#9ab; display:none"></div>
        </div>
      </div>
      <div class="panel response-panel" style="flex:1.2">
        <div id="status"></div>
        <div id="responseMeta">
          <span id="respStatusCode" class="tag"></span>
          <span id="respTime" class="tag"></span>
          <span id="respSize" class="tag"></span>
        </div>
        <div id="responseTabs">
          <div class="resp-tab active" data-rtab="responseBody">Body</div>
          <div class="resp-tab" data-rtab="responseHeaders">Headers</div>
          <div class="resp-tab" data-rtab="responsePreview">Preview</div>
          <div class="resp-tab" data-rtab="responseRaw">Raw</div>
        </div>
        <div class="response-actions" style="margin-bottom:6px;">
          <button id="copyResponseBtn" class="btn-secondary" title="Copy response body">Copy Body üìã</button>
        </div>
        <div id="responseBody" class="response-area">Response s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y...</div>
        <div id="responseHeaders" class="response-area" style="display:none"></div>
        <div id="responsePreview" class="response-area" style="display:none"></div>
        <div id="responseRaw" class="response-area" style="display:none"></div>
      </div>
    </main>
  </div>
  <div class="bottom-bar">üöÄ Postman Lite - Collections ‚Ä¢ History ‚Ä¢ Environments</div>

  <!-- Collection Modal -->
  <div id="collectionModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="collectionModalTitle">T·∫°o Collection M·ªõi</h3>
        <button class="modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <input type="hidden" id="collectionId" />
        <div class="form-group">
          <label>T√™n Collection *</label>
          <input type="text" id="collectionName" placeholder="My API Collection" required />
        </div>
        <div class="form-group">
          <label>M√¥ t·∫£</label>
          <textarea id="collectionDescription" placeholder="M√¥ t·∫£ v·ªÅ collection..." rows="3"></textarea>
        </div>
        <div class="form-group">
          <label>Collection cha (optional)</label>
          <select id="collectionParent">
            <option value="">-- Kh√¥ng c√≥ (Root) --</option>
          </select>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn-secondary modal-dismiss">H·ªßy</button>
        <button class="btn-primary" id="saveCollectionBtn">L∆∞u</button>
      </div>
    </div>
  </div>

  <!-- Request Modal -->
  <div id="requestModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="requestModalTitle">T·∫°o Request M·ªõi</h3>
        <button class="modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <input type="hidden" id="requestId" />
        <div class="form-group">
          <label>T√™n Request *</label>
          <input type="text" id="requestName" placeholder="Get Users" required />
        </div>
        <div class="form-group">
          <label>Collection</label>
          <select id="requestCollection">
            <option value="">-- Kh√¥ng thu·ªôc collection n√†o --</option>
          </select>
        </div>
        <p style="color:#9ab;font-size:12px;margin-top:10px;">üí° Request s·∫Ω l·∫•y c·∫•u h√¨nh hi·ªán t·∫°i t·ª´ form (method, URL, headers, body, auth...)</p>
      </div>
      <div class="modal-footer">
        <button class="btn-secondary modal-dismiss">H·ªßy</button>
        <button class="btn-primary" id="saveRequestBtn">L∆∞u</button>
      </div>
    </div>
  </div>

  <!-- Environment Management Modal -->
  <div id="envModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Environments</h3>
        <button class="modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label>T√™n Environment *</label>
          <input type="text" id="envName" placeholder="Local" />
        </div>
        <div class="kv-container" id="envVarsContainer"></div>
        <button class="add" id="addEnvVarBtn">+ Th√™m bi·∫øn</button>
        <div style="margin-top:10px; font-size:12px; color:#9ab;">D√πng {{VAR_NAME}} trong URL, headers, body...</div>
        <div class="env-list" id="envList"></div>
      </div>
      <div class="modal-footer">
        <button class="btn-secondary modal-dismiss">ƒê√≥ng</button>
        <button class="btn-primary" id="saveEnvBtn">L∆∞u / C·∫≠p nh·∫≠t</button>
      </div>
    </div>
  </div>

  <!-- Import Data Modal -->
  <div id="importModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Import Data JSON</h3>
        <button class="modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <textarea id="importDataTextarea" placeholder="Paste JSON ·ªü ƒë√¢y" rows="10" style="width:100%;"></textarea>
      </div>
      <div class="modal-footer">
        <button class="btn-secondary modal-dismiss">H·ªßy</button>
        <button class="btn-primary" id="doImportBtn">Import</button>
      </div>
    </div>
  </div>

  <!-- Export Data Modal -->
  <div id="exportModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Export Data JSON</h3>
        <button class="modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <textarea id="exportDataTextarea" readonly rows="10" style="width:100%;"></textarea>
      </div>
      <div class="modal-footer">
        <button class="btn-secondary modal-dismiss">ƒê√≥ng</button>
        <button class="btn-primary" id="downloadExportBtn">T·∫£i xu·ªëng</button>
      </div>
    </div>
  </div>

  <script src="storage.js"></script>
  <script src="curl-parser.js"></script>
  <script src="sidebar.js"></script>
  <script src="env.js"></script>
  <script src="response-viewer.js"></script>
  <script src="search.js"></script>
  <script src="app.js"></script>
</body>
</html>
